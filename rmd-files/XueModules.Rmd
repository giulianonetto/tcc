---
title: "XueModules"
author: "Giuliano Netto Flores Cruz"
date: "September 20, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_knit$set(echo = TRUE, root.dir = '/home/giulianonetto/windows/tcc/checklist/genesigs/papers/Xue, 2014')
library(DT)
```
# Modules from Xue, 2014.
9498 unique present genes were clustered into 49 modules. 
M1-, M2- and TPP-associated modules are 7-9, 13-15, and 30, 32-33, respecitively.

```{r fig.height = 6, fig.width = 9, fig.align = "center", echo=FALSE, warning=FALSE, out }

library(stringr)
library(ggplot2)
dat <- read.table('modules.csv', sep = '\t', header = T, stringsAsFactors = F)

dat_colnames <- colnames(dat)
dat_colnames_new = vector()
for (i in 1:ncol(dat)){
  old <- str_extract(dat_colnames[i], "[0-9]+")
  new = paste0("Module", old)
  dat_colnames_new = c(dat_colnames_new, new)
}
colnames(dat) <- dat_colnames_new

datatable(dat, rownames = FALSE, filter = 'top',
          caption = "Table 1. Modules defined by Xue, 2014.",
          options=list(pageLength = 100, scrollX='400px', scrollY='400px',
          lengthMenu = c(30, 100, 1000) 

  )
)

# make bar plot for numb of genes per module
colcount <- data.frame()
for(i in 1:ncol(dat)){
  module = colnames(dat)[i]
  Counts =  length(unique(dat[[i]])) - 1
  colcount = rbind(colcount,data.frame(module, Counts))
}

ggplot(colcount, aes(x=module, y=Counts))+
  geom_bar(width = 0.75, position = position_dodge(width = 0.9), stat = "identity")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  guides(fill=FALSE, colour=FALSE)+
  ylab("Number of genes")+
  ggtitle("Number of genes per module")+
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16))

```

List of Genes used for the 49 modules defined by Xue, 2014 - human and mouse
orthologs. Human gene symbols were converted to the respective mouse orthologues by combining information from Ensembl BioMart ( http://www.ensembl.org/biomart/martview ) using the species specific gene symbols. For some of the genes, BioGPS (http://biogps.org/#goto=welcome) was used if no orthologue was found in BioMart.

```{r echo=FALSE}
human_mouse_map = read.csv('/home/giulianonetto/windows/tcc/checklist/genesigs/human_mouse.map', sep = '\t', header = T, stringsAsFactors = F)

suppressWarnings(datatable(human_mouse_map, filter = 'top',
          caption = "Table 2. Human genes from macrophage modules by Xue, 2014 - along with mouse orthologs.",
          options=list(pageLength = 100, scrollX='400px', scrollY='400px',
          lengthMenu = c(30, 100, 1000))))

```

